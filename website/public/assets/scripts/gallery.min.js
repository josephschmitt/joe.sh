/*! joe.sh 25-03-2013 */
(function(e,t){"use strict";var n,r=e.document,i=e.Modernizr,o=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},s="Moz Webkit O Ms".split(" "),a=function(e){var t,n=r.documentElement.style;if("string"==typeof n[e])return e;e=o(e);for(var i=0,a=s.length;a>i;i++)if(t=s[i]+e,"string"==typeof n[t])return t},u=a("transform"),l=a("transitionProperty"),c={csstransforms:function(){return!!u},csstransforms3d:function(){var e=!!a("perspective");if(e){var n=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),r="@media ("+n.join("transform-3d),(")+"modernizr)",i=t("<style>"+r+"{#modernizr{height:3px}}"+"</style>").appendTo("head"),o=t('<div id="modernizr" />').appendTo("html");e=3===o.height(),o.remove(),i.remove()}return e},csstransitions:function(){return!!l}};if(i)for(n in c)i.hasOwnProperty(n)||i.addTest(n,c[n]);else{i=e.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var f,p=" ";for(n in c)f=c[n](),i[n]=f,p+=" "+(f?"":"no-")+n;t("html").addClass(p)}if(i.csstransforms){var d=i.csstransforms3d?{translate:function(e){return"translate3d("+e[0]+"px, "+e[1]+"px, 0) "},scale:function(e){return"scale3d("+e+", "+e+", 1) "}}:{translate:function(e){return"translate("+e[0]+"px, "+e[1]+"px) "},scale:function(e){return"scale("+e+") "}},h=function(e,n,r){var i,o,s=t.data(e,"isoTransform")||{},a={},l={};a[n]=r,t.extend(s,a);for(i in s)o=s[i],l[i]=d[i](o);var c=l.translate||"",f=l.scale||"",p=c+f;t.data(e,"isoTransform",s),e.style[u]=p};t.cssNumber.scale=!0,t.cssHooks.scale={set:function(e,t){h(e,"scale",t)},get:function(e){var n=t.data(e,"isoTransform");return n&&n.scale?n.scale:1}},t.fx.step.scale=function(e){t.cssHooks.scale.set(e.elem,e.now+e.unit)},t.cssNumber.translate=!0,t.cssHooks.translate={set:function(e,t){h(e,"translate",t)},get:function(e){var n=t.data(e,"isoTransform");return n&&n.translate?n.translate:[0,0]}}}var m,g;i.csstransitions&&(m={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[l],g=a("transitionDuration"));var y,v=t.event,b=t.event.handle?"handle":"dispatch";v.special.smartresize={setup:function(){t(this).bind("resize",v.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",v.special.smartresize.handler)},handler:function(e,t){var n=this,r=arguments;e.type="smartresize",y&&clearTimeout(y),y=setTimeout(function(){v[b].apply(n,r)},"execAsap"===t?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Isotope=function(e,n,r){this.element=t(n),this._create(e),this._init(r)};var x=["width","height"],w=t(e);t.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},t.Isotope.prototype={_create:function(e){this.options=t.extend({},t.Isotope.settings,e),this.styleQueue=[],this.elemCount=0;var n=this.element[0].style;this.originalStyle={};var r=x.slice(0);for(var i in this.options.containerStyle)r.push(i);for(var o=0,s=r.length;s>o;o++)i=r[o],this.originalStyle[i]=n[i]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var a={"original-order":function(e,t){return t.elemCount++,t.elemCount},random:function(){return Math.random()}};this.options.getSortData=t.extend(this.options.getSortData,a),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var u=this;setTimeout(function(){u.element.addClass(u.options.containerClass)},0),this.options.resizable&&w.bind("smartresize.isotope",function(){u.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(e){var t=this.options.itemSelector,n=t?e.filter(t).add(e.find(t)):e,r={position:"absolute"};return n=n.filter(function(e,t){return 1===t.nodeType}),this.usingTransforms&&(r.left=0,r.top=0),n.css(r).addClass(this.options.itemClass),this.updateSortData(n,!0),n},_init:function(e){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(e)},option:function(e){if(t.isPlainObject(e)){this.options=t.extend(!0,this.options,e);var n;for(var r in e)n="_update"+o(r),this[n]&&this[n]()}},_updateAnimationEngine:function(){var e,t=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"");switch(t){case"css":case"none":e=!1;break;case"jquery":e=!0;break;default:e=!i.csstransitions}this.isUsingJQueryAnimation=e,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var e=this.usingTransforms=this.options.transformsEnabled&&i.csstransforms&&i.csstransitions&&!this.isUsingJQueryAnimation;e||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=e?this._translate:this._positionAbs},_filter:function(e){var t=""===this.options.filter?"*":this.options.filter;if(!t)return e;var n=this.options.hiddenClass,r="."+n,i=e.filter(r),o=i;if("*"!==t){o=i.filter(t);var s=e.not(r).not(t).addClass(n);this.styleQueue.push({$el:s,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:o,style:this.options.visibleStyle}),o.removeClass(n),e.filter(t)},updateSortData:function(e,n){var r,i,o=this,s=this.options.getSortData;e.each(function(){r=t(this),i={};for(var e in s)i[e]=n||"original-order"!==e?s[e](r,o):t.data(this,"isotope-sort-data")[e];t.data(this,"isotope-sort-data",i)})},_sort:function(){var e=this.options.sortBy,t=this._getSorter,n=this.options.sortAscending?1:-1,r=function(r,i){var o=t(r,e),s=t(i,e);return o===s&&"original-order"!==e&&(o=t(r,"original-order"),s=t(i,"original-order")),(o>s?1:s>o?-1:0)*n};this.$filteredAtoms.sort(r)},_getSorter:function(e,n){return t.data(e,"isotope-sort-data")[n]},_translate:function(e,t){return{translate:[e,t]}},_positionAbs:function(e,t){return{left:e,top:t}},_pushPosition:function(e,t,n){t=Math.round(t+this.offset.left),n=Math.round(n+this.offset.top);var r=this.getPositionStyles(t,n);this.styleQueue.push({$el:e,style:r}),this.options.itemPositionDataEnabled&&e.data("isotope-item-position",{x:t,y:n})},layout:function(e,t){var n=this.options.layoutMode;if(this["_"+n+"Layout"](e),this.options.resizesContainer){var r=this["_"+n+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:r})}this._processStyleQueue(e,t),this.isLaidOut=!0},_processStyleQueue:function(e,n){var r,o,s,a,u=this.isLaidOut?this.isUsingJQueryAnimation?"animate":"css":"css",l=this.options.animationOptions,c=this.options.onLayout;if(o=function(e,t){t.$el[u](t.style,l)},this._isInserting&&this.isUsingJQueryAnimation)o=function(e,t){r=t.$el.hasClass("no-transition")?"css":u,t.$el[r](t.style,l)};else if(n||c||l.complete){var f=!1,p=[n,c,l.complete],d=this;if(s=!0,a=function(){if(!f){for(var t,n=0,r=p.length;r>n;n++)t=p[n],"function"==typeof t&&t.call(d.element,e,d);f=!0}},this.isUsingJQueryAnimation&&"animate"===u)l.complete=a,s=!1;else if(i.csstransitions){for(var h,y=0,v=this.styleQueue[0],b=v&&v.$el;!b||!b.length;){if(h=this.styleQueue[y++],!h)return;b=h.$el}var x=parseFloat(getComputedStyle(b[0])[g]);x>0&&(o=function(e,t){t.$el[u](t.style,l).one(m,a)},s=!1)}}t.each(this.styleQueue,o),s&&a(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(e){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,e)},addItems:function(e,t){var n=this._getAtoms(e);this.$allAtoms=this.$allAtoms.add(n),t&&t(n)},insert:function(e,t){this.element.append(e);var n=this;this.addItems(e,function(e){var r=n._filter(e);n._addHideAppended(r),n._sort(),n.reLayout(),n._revealAppended(r,t)})},appended:function(e,t){var n=this;this.addItems(e,function(e){n._addHideAppended(e),n.layout(e),n._revealAppended(e,t)})},_addHideAppended:function(e){this.$filteredAtoms=this.$filteredAtoms.add(e),e.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:e,style:this.options.hiddenStyle})},_revealAppended:function(e,t){var n=this;setTimeout(function(){e.removeClass("no-transition"),n.styleQueue.push({$el:e,style:n.options.visibleStyle}),n._isInserting=!1,n._processStyleQueue(e,t)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(e,t){this.$allAtoms=this.$allAtoms.not(e),this.$filteredAtoms=this.$filteredAtoms.not(e);var n=this,r=function(){e.remove(),t&&t.call(n.element)};e.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:e,style:this.options.hiddenStyle}),this._sort(),this.reLayout(r)):r()},shuffle:function(e){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(e)},destroy:function(){var e=this.usingTransforms,t=this.options;this.$allAtoms.removeClass(t.hiddenClass+" "+t.itemClass).each(function(){var t=this.style;t.position="",t.top="",t.left="",t.opacity="",e&&(t[u]="")});var n=this.element[0].style;for(var r in this.originalStyle)n[r]=this.originalStyle[r];this.element.unbind(".isotope").undelegate("."+t.hiddenClass,"click").removeClass(t.containerClass).removeData("isotope"),w.unbind(".isotope")},_getSegments:function(e){var t,n=this.options.layoutMode,r=e?"rowHeight":"columnWidth",i=e?"height":"width",s=e?"rows":"cols",a=this.element[i](),u=this.options[n]&&this.options[n][r]||this.$filteredAtoms["outer"+o(i)](!0)||a;t=Math.floor(a/u),t=Math.max(t,1),this[n][s]=t,this[n][r]=u},_checkIfSegmentsChanged:function(e){var t=this.options.layoutMode,n=e?"rows":"cols",r=this[t][n];return this._getSegments(e),this[t][n]!==r},_masonryReset:function(){this.masonry={},this._getSegments();var e=this.masonry.cols;for(this.masonry.colYs=[];e--;)this.masonry.colYs.push(0)},_masonryLayout:function(e){var n=this,r=n.masonry;e.each(function(){var e=t(this),i=Math.ceil(e.outerWidth(!0)/r.columnWidth);if(i=Math.min(i,r.cols),1===i)n._masonryPlaceBrick(e,r.colYs);else{var o,s,a=r.cols+1-i,u=[];for(s=0;a>s;s++)o=r.colYs.slice(s,s+i),u[s]=Math.max.apply(Math,o);n._masonryPlaceBrick(e,u)}})},_masonryPlaceBrick:function(e,t){for(var n=Math.min.apply(Math,t),r=0,i=0,o=t.length;o>i;i++)if(t[i]===n){r=i;break}var s=this.masonry.columnWidth*r,a=n;this._pushPosition(e,s,a);var u=n+e.outerHeight(!0),l=this.masonry.cols+1-o;for(i=0;l>i;i++)this.masonry.colYs[r+i]=u},_masonryGetContainerSize:function(){var e=Math.max.apply(Math,this.masonry.colYs);return{height:e}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(e){var n=this,r=this.element.width(),i=this.fitRows;e.each(function(){var e=t(this),o=e.outerWidth(!0),s=e.outerHeight(!0);0!==i.x&&o+i.x>r&&(i.x=0,i.y=i.height),n._pushPosition(e,i.x,i.y),i.height=Math.max(i.y+s,i.height),i.x+=o})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(e){var n=this,r=this.cellsByRow;e.each(function(){var e=t(this),i=r.index%r.cols,o=Math.floor(r.index/r.cols),s=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,a=(o+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,s,a),r.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(e){var n=this;e.each(function(){var e=t(this);n._pushPosition(e,0,n.straightDown.y),n.straightDown.y+=e.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var e=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];e--;)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(e){var n=this,r=n.masonryHorizontal;e.each(function(){var e=t(this),i=Math.ceil(e.outerHeight(!0)/r.rowHeight);if(i=Math.min(i,r.rows),1===i)n._masonryHorizontalPlaceBrick(e,r.rowXs);else{var o,s,a=r.rows+1-i,u=[];for(s=0;a>s;s++)o=r.rowXs.slice(s,s+i),u[s]=Math.max.apply(Math,o);n._masonryHorizontalPlaceBrick(e,u)}})},_masonryHorizontalPlaceBrick:function(e,t){for(var n=Math.min.apply(Math,t),r=0,i=0,o=t.length;o>i;i++)if(t[i]===n){r=i;break}var s=n,a=this.masonryHorizontal.rowHeight*r;this._pushPosition(e,s,a);var u=n+e.outerWidth(!0),l=this.masonryHorizontal.rows+1-o;for(i=0;l>i;i++)this.masonryHorizontal.rowXs[r+i]=u},_masonryHorizontalGetContainerSize:function(){var e=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:e}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(e){var n=this,r=this.element.height(),i=this.fitColumns;e.each(function(){var e=t(this),o=e.outerWidth(!0),s=e.outerHeight(!0);0!==i.y&&s+i.y>r&&(i.x=i.width,i.y=0),n._pushPosition(e,i.x,i.y),i.width=Math.max(i.x+o,i.width),i.y+=s})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function(e){var n=this,r=this.cellsByColumn;e.each(function(){var e=t(this),i=Math.floor(r.index/r.rows),o=r.index%r.rows,s=(i+.5)*r.columnWidth-e.outerWidth(!0)/2,a=(o+.5)*r.rowHeight-e.outerHeight(!0)/2;n._pushPosition(e,s,a),r.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(e){var n=this;e.each(function(){var e=t(this);n._pushPosition(e,n.straightAcross.x,0),n.straightAcross.x+=e.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},t.fn.imagesLoaded=function(e){function n(){e.call(i,o)}function r(e){var i=e.target;i.src!==a&&-1===t.inArray(i,u)&&(u.push(i),0>=--s&&(setTimeout(n),o.unbind(".imagesLoaded",r)))}var i=this,o=i.find("img").add(i.filter("img")),s=o.length,a="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",u=[];return s||n(),o.bind("load.imagesLoaded error.imagesLoaded",r).each(function(){var e=this.src;this.src=a,this.src=e}),i};var T=function(t){e.console&&e.console.error(t)};t.fn.isotope=function(e,n){if("string"==typeof e){var r=Array.prototype.slice.call(arguments,1);this.each(function(){var n=t.data(this,"isotope");return n?t.isFunction(n[e])&&"_"!==e.charAt(0)?(n[e].apply(n,r),void 0):(T("no such method '"+e+"' for isotope instance"),void 0):(T("cannot call methods on isotope prior to initialization; attempted to call method '"+e+"'"),void 0)})}else this.each(function(){var r=t.data(this,"isotope");r?(r.option(e),r._init(n)):t.data(this,"isotope",new t.Isotope(e,this,n))});return this}})(window,jQuery),$(".media ul").children().length>1&&$(".media").isotope({itemSelector:"li",layoutMode:"masonryHorizontal",containerStyle:{position:"absolute"},resizesContainer:!1});